# 机械臂智能体项目文件调用关系

## 项目概述
这是一个基于AI的机械臂智能体项目，能够实现听懂语音指令、看懂图像、执行相应动作的功能。主要由以下几部分组成：

1. **主程序模块**：agent_go.py
2. **API配置模块**：API_KEY.py
3. **智能体编排模块**：utils_agent.py
4. **语音识别模块**：utils_asr.py
5. **摄像头控制模块**：utils_camera.py
6. **拖动示教模块**：utils_drag_teaching.py
7. **LED灯控制模块**：utils_led.py
8. **大语言模型模块**：utils_llm.py
9. **吸泵控制模块**：utils_pump.py
10. **机械臂控制模块**：utils_robot.py
11. **语音合成模块**：utils_tts.py
12. **多模态大模型模块**：utils_vlm.py
13. **多模态运动控制模块**：utils_vlm_move.py
14. **工具检查模块**：camera_check.py, sound_check.py

## 文件调用关系图

```
┌────────────────┐     ┌────────────────┐     ┌────────────────┐
│   agent_go.py  │────▶│ utils_agent.py │────▶│  utils_llm.py  │
└────────────────┘     └────────────────┘     └────────────────┘
        │                      ▲                     │
        │                      │                     │
        ▼                      │                     ▼
┌────────────────┐     ┌────────────────┐     ┌────────────────┐
│utils_vlm_move.py│────▶│ utils_robot.py │────▶│ utils_led.py   │
└────────────────┘     └────────────────┘     └────────────────┘
        │                      ▲                     │
        │                      │                     │
        ▼                      │                     ▼
┌────────────────┐     ┌────────────────┐     ┌────────────────┐
│  utils_vlm.py  │────▶│ utils_pump.py  │     │  utils_asr.py  │
└────────────────┘     └────────────────┘     └────────────────┘
        │                      │                     │
        │                      │                     │
        ▼                      ▼                     ▼
┌────────────────┐     ┌────────────────┐     ┌────────────────┐
│  utils_tts.py  │     │utils_camera.py │     │utils_drag_tea. │
└────────────────┘     └────────────────┘     └────────────────┘
```

## 详细调用关系说明

### 1. 主程序入口 (agent_go.py)
- 调用所有工具模块
- 是整个系统的入口点
- 主要功能：初始化系统、接收用户指令、协调各模块工作

### 2. 智能体编排 (utils_agent.py)
- 调用：utils_llm.py
- 功能：定义智能体系统提示词，根据用户指令规划机械臂动作

### 3. 语音识别 (utils_asr.py)
- 调用：API_KEY.py
- 功能：录音、语音识别

### 4. 机械臂控制 (utils_robot.py)
- 调用：utils_pump.py
- 功能：机械臂运动控制（归零、关节控制、坐标移动等）

### 5. 多模态运动控制 (utils_vlm_move.py)
- 调用：utils_robot.py, utils_asr.py, utils_vlm.py
- 功能：利用多模态大模型识别图像，控制机械臂移动物体

### 6. 多模态大模型 (utils_vlm.py)
- 调用：utils_tts.py, API_KEY.py
- 功能：调用多模态大模型API进行图像识别和理解

### 7. 大语言模型 (utils_llm.py)
- 调用：API_KEY.py
- 功能：调用大语言模型API进行自然语言处理

### 8. LED灯控制 (utils_led.py)
- 调用：utils_llm.py, utils_robot.py
- 功能：通过大语言模型理解颜色指令，控制LED灯颜色

### 9. 语音合成 (utils_tts.py)
- 功能：将文本转换为语音，播放语音

### 10. 吸泵控制 (utils_pump.py)
- 功能：控制吸泵的开关，用于抓取物体

### 11. 摄像头控制 (utils_camera.py)
- 功能：摄像头的初始化和图像捕获

### 12. 拖动示教 (utils_drag_teaching.py)
- 功能：实现机械臂的拖动示教功能

### 13. 工具检查模块
- camera_check.py：独立的摄像头检查工具
- sound_check.py：调用utils_asr.py和utils_tts.py，检查声音相关功能

### 14. API配置 (API_KEY.py)
- 被utils_asr.py, utils_llm.py, utils_vlm.py导入使用
- 功能：存储各种API密钥

## 核心流程

1. **用户输入**：用户通过语音或键盘输入指令
2. **语音识别**：utils_asr.py将语音转换为文本
3. **智能体规划**：utils_agent.py和utils_llm.py分析指令，生成动作序列
4. **动作执行**：
   - 如果涉及图像识别，调用utils_camera.py拍照，utils_vlm.py分析图像
   - 根据规划的动作序列，调用utils_robot.py控制机械臂运动
   - 必要时调用utils_pump.py控制吸泵，utils_led.py控制LED灯
5. **语音反馈**：通过utils_tts.py将执行结果以语音形式反馈给用户

## 数据流向

```
用户指令 → 语音识别 → 智能体规划 → 图像识别（可选） → 机械臂动作 → 执行结果 → 语音反馈
```

## 关键功能模块

1. **多模态交互**：结合语音识别、图像识别和自然语言处理，实现多模态交互
2. **智能规划**：通过大语言模型理解用户意图，规划机械臂动作序列
3. **视觉定位**：利用多模态大模型识别图像中的物体，实现精确定位
4. **拖动示教**：支持用户手动拖动机械臂，记录并复现动作

这个项目实现了一个功能完整的机械臂智能体，能够听懂人话、看懂图像、执行相应的动作，体现了具身智能的基本理念。